<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Quiz: Aventura da Intelig√™ncia Artificial üöÄ</title>
  <style>
    :root {
      --bg: #e6f3ff;
      --card: #ffffff;
      --accent: #1e90ff;
      --accent-2: #ff69b4;
      --text: #022c43;
      --success: #28a745;
      --error: #dc3545;
      --glow: #40c4ff;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Courier New', Courier, monospace;
      color: var(--text);
      background: linear-gradient(180deg, var(--bg), #d6eaff);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
      overflow-x: hidden;
      position: relative;
    }
    .app {
      width: 100%;
      max-width: 980px;
      background: var(--card);
      border-radius: 16px;
      box-shadow: 0 12px 40px rgba(10,20,40,0.1);
      overflow: hidden;
      position: relative;
      z-index: 10;
    }
    header {
      display: flex;
      gap: 16px;
      align-items: center;
      padding: 20px 28px;
      background: linear-gradient(90deg, var(--accent), var(--accent-2));
      color: white;
      text-shadow: 0 1px 2px rgba(0,0,0,0.2);
    }
    header h1 { font-size: 22px; margin: 0; font-weight: bold; }
    header p { margin: 0; font-size: 14px; opacity: 0.9; }
    .content { padding: 32px; }
    .progress {
      height: 14px;
      background: #e0efff;
      border-radius: 999px;
      overflow: hidden;
      margin-bottom: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .progress > i {
      display: block;
      height: 100%;
      background: linear-gradient(90deg, var(--accent), var(--accent-2));
      width: 0;
      transition: width 0.4s ease;
      box-shadow: inset 0 0 10px var(--glow);
    }
    .card {
      background: linear-gradient(180deg, #ffffff, #f8fbff);
      border-radius: 14px;
      padding: 24px;
      border: 1px solid #e0efff;
      text-align: center;
    }
    .qtitle { font-size: 18px; margin: 0 0 10px 0; font-weight: bold; }
    .qtext { font-size: 24px; margin: 0 0 16px 0; font-weight: bold; text-shadow: 0 1px 1px rgba(0,0,0,0.1); }
    .options {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      position: relative;
      min-height: 120px;
    }
    .opt {
      padding: 14px;
      border-radius: 12px;
      border: 2px solid #e0efff;
      background: linear-gradient(180deg, #ffffff, #f8fbff);
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      transition: transform 0.15s ease, box-shadow 0.15s ease;
      position: relative;
      box-shadow: 0 4px 12px rgba(10,20,40,0.08);
    }
    .opt:hover:not(.disabled) {
      transform: translateY(-4px);
      box-shadow: 0 8px 24px rgba(10,20,40,0.12);
    }
    .opt.correct {
      border-color: var(--success);
      background: linear-gradient(180deg, #e6ffed, #d4ffe2);
      box-shadow: 0 0 12px var(--success);
      animation: bounce 0.3s ease;
    }
    .opt.wrong {
      border-color: var(--error);
      background: linear-gradient(180deg, #ffe6e6, #ffdede);
      animation: wobble 0.4s ease;
    }
    .opt.disabled { pointer-events: none; opacity: 0.6; }
    .controls {
      display: flex;
      gap: 12px;
      justify-content: space-between;
      align-items: center;
      margin-top: 20px;
      flex-wrap: wrap;
    }
    .btn {
      background: var(--accent);
      color: white;
      padding: 12px 20px;
      border-radius: 12px;
      border: 0;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      transition: transform 0.15s ease, box-shadow 0.15s ease;
      text-shadow: 0 1px 1px rgba(0,0,0,0.2);
    }
    .btn:hover {
      transform: scale(1.08);
      box-shadow: 0 6px 20px rgba(0,0,0,0.15);
    }
    .btn.ghost {
      background: transparent;
      color: var(--accent);
      border: 2px solid var(--accent);
      text-shadow: none;
    }
    .small { font-size: 14px; color: #4a6f80; font-weight: bold; }
    .footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 16px;
      font-size: 14px;
      flex-wrap: wrap;
      gap: 8px;
    }
    .score-box { display: flex; gap: 12px; align-items: center; flex-wrap: wrap; }
    .badge {
      background: #f8fbff;
      border-radius: 10px;
      padding: 8px 12px;
      font-weight: bold;
      border: 1px solid #e0efff;
    }
    .result, .phase-screen { padding: 32px; text-align: center; position: relative; }
    .result h2, .phase-screen h2 { font-size: 26px; margin: 0 0 12px 0; font-weight: bold; }
    .explain {
      margin-top: 16px;
      background: #f0f8ff;
      padding: 12px;
      border-radius: 10px;
      border: 1px dashed #d0e8ff;
      color: #0a4a70;
      font-size: 15px;
      animation: fadeIn 0.5s ease;
    }
    .phase-screen {
      display: none;
      background: linear-gradient(180deg, #ffffff, #f0f8ff);
    }
    .timer { font-size: 16px; font-weight: bold; color: var(--accent-2); margin-bottom: 16px; }
    canvas#confetti { position: fixed; top: 0; left: 0; pointer-events: none; z-index: 1000; }
    .stars {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0.3;
      z-index: 0;
      pointer-events: none; /* <-- evita que bloqueie cliques no bot√£o */
    }
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-6px); }
    }
    @keyframes wobble {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-6px) rotate(-3deg); }
      75% { transform: translateX(6px) rotate(3deg); }
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(12px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @media (max-width: 640px) {
      .options { grid-template-columns: 1fr; }
      .qtext { font-size: 20px; }
      .opt { font-size: 15px; padding: 12px; }
      .btn { padding: 10px 16px; font-size: 14px; }
      header h1 { font-size: 18px; }
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div style="display:flex;flex-direction:column">
        <h1>Quiz: Aventura da Intelig√™ncia Artificial ü§ñüöÄ</h1>
        <p>Explore, aprenda e divirta-se com IA!</p>
      </div>
      <div style="margin-left:auto;text-align:right">
        <div class="small">Perguntas: <strong id="total">20</strong></div>
        <div class="small">Vidas: <span id="lives">3</span> ‚ù§Ô∏è</div>
      </div>
    </header>

    <div class="content">
      <div class="progress"><i id="bar"></i></div>

      <div class="card" id="quizCard">
        <div>
          <div class="qtitle small">Pergunta <span id="index">1</span> de <span id="count">20</span> | Fase <span id="phase">1</span></div>
          <h2 class="qtext" id="question">Carregando...</h2>
          <div class="timer" id="timer" style="display:none">‚è±Ô∏è Tempo: <span id="timeLeft">10</span>s</div>
        </div>

        <div class="options" id="options"></div>

        <div class="controls">
          <div class="score-box">
            <div class="badge">Pontua√ß√£o: <span id="score">0</span></div>
            <div class="small">Acertos: <span id="hits">0</span></div>
          </div>
        </div>

        <div class="footer">
          <div class="small">üí° Dica: As respostas podem te enganar!</div>
          <div class="small">ü§ñ Fique atento aos bot√µes!</div>
        </div>
      </div>

      <div id="phaseScreen" class="card phase-screen">
        <div class="stars">‚ú®</div>
        <h2 id="phaseTitle">Fase Conclu√≠da! üéâ</h2>
        <p id="phaseMessage" style="font-size:18px;margin:16px 0">Voc√™ avan√ßou na aventura!</p>
        <button class="btn" id="continuePhase">Continuar Aventura üöÄ</button>
      </div>

      <div id="result" style="display:none" class="card result">
        <div class="stars">‚≠ê</div>
        <h2 id="resultTitle">Fim da Aventura! üéâ</h2>
        <div style="margin:20px 0">
          <div style="font-size:18px;margin-bottom:12px">
            <strong>Pontua√ß√£o Final:</strong> <span id="finalScore" style="font-size:24px;color:var(--accent)">0</span> / <span id="maxScore">200</span>
          </div>
          <div style="font-size:18px;margin-bottom:12px">
            <strong>Acertos:</strong> <span id="finalHits">0</span> de <span id="totalQuestions">20</span>
          </div>
          <div style="font-size:32px;margin:16px 0">
            <span id="starRating">‚òÖ‚òÖ‚òÖ</span>
          </div>
        </div>
        <div class="explain" id="finalMessage"></div>
        <div style="margin-top:20px;display:flex;gap:12px;justify-content:center;flex-wrap:wrap">
          <button class="btn" id="restart">üîÑ Tentar Novamente</button>
          <button class="btn" id="download" style="background:var(--accent-2)">üì• Baixar Resultados</button>
        </div>
      </div>
    </div>
  </div>
  <canvas id="confetti"></canvas>

  <script>
    const QUESTIONS = [
      {q: 'O que √© Intelig√™ncia Artificial (IA)? ü§ñ', opts: ['Um tipo de computador que aprende','Um brinquedo','Um filme','Um animal'], a: 0, explain: 'IA √© quando computadores aprendem com exemplos para ajudar as pessoas.'},
      {q: 'Onde podemos ver IA no dia a dia?', opts: ['Em celulares e jogos','S√≥ em filmes','S√≥ em rob√¥s gigantes','Em plantas'], a: 0, explain: 'IA est√° em nosso celular, em jogos, nas recomenda√ß√µes de v√≠deos e assistentes.'},
      {q: 'O que um assistente virtual faz?', opts: ['Responde perguntas e ajuda','Faz m√°gica','Come pizza','Voa'], a: 0, explain: 'Assistentes virtuais como Alexa e Siri usam IA para responder perguntas.'},
      {q: 'Como a IA aprende?', opts: ['Com muitos exemplos','Sozinha sem ajuda','Por telepatia','Comendo dados'], a: 0, explain: 'IA aprende analisando muitos exemplos, como mostrar fotos de gatos para reconhec√™-los.'},
      {q: 'Qual destes usa IA para recomendar v√≠deos?', opts: ['YouTube','Caderno','L√°pis','Mesa'], a: 0, explain: 'YouTube usa IA para sugerir v√≠deos que voc√™ pode gostar baseado no que assistiu.'},
      
      {q: 'O que √© Machine Learning?', opts: ['Aprendizado de m√°quina','M√°quina de lavar','Bicicleta','Videogame'], a: 0, explain: 'Machine Learning √© quando computadores aprendem padr√µes nos dados.'},
      {q: 'Qual animal os cientistas estudam para criar rob√¥s?', opts: ['Todos os animais','Apenas dinossauros','S√≥ plantas','Nenhum'], a: 0, explain: 'Cientistas observam v√°rios animais para criar rob√¥s inspirados na natureza.'},
      {q: 'O que √© um chatbot?', opts: ['Programa que conversa','Um brinquedo','Uma comida','Uma planta'], a: 0, explain: 'Chatbots s√£o programas que usam IA para conversar com pessoas.'},
      {q: 'A IA pode ajudar m√©dicos?', opts: ['Sim, analisando exames','N√£o, nunca','S√≥ em filmes','Apenas em jogos'], a: 0, explain: 'IA pode ajudar m√©dicos a identificar doen√ßas em imagens de raio-X.'},
      {q: 'O que s√£o dados para a IA?', opts: ['Informa√ß√µes que ela aprende','Comida','Brinquedos','Roupas'], a: 0, explain: 'Dados s√£o informa√ß√µes (texto, imagens, n√∫meros) que a IA usa para aprender.'},
      
      {q: 'Rob√¥s podem ter sentimentos de verdade?', opts: ['N√£o, apenas simulam','Sim, todos t√™m','S√≥ os grandes','S√≥ os pequenos'], a: 0, explain: 'Rob√¥s n√£o t√™m sentimentos reais, mas podem simular emo√ß√µes.'},
      {q: 'O que √© reconhecimento facial?', opts: ['IA identifica rostos','Um jogo','Um tipo de dan√ßa','Uma receita'], a: 0, explain: 'Reconhecimento facial usa IA para identificar pessoas por suas faces.'},
      {q: 'A IA pode criar m√∫sicas?', opts: ['Sim, pode compor','N√£o, nunca','S√≥ rock','S√≥ cl√°ssica'], a: 0, explain: 'IA pode compor m√∫sicas analisando milhares de can√ß√µes existentes.'},
      {q: 'O que s√£o algoritmos?', opts: ['Passos para resolver problemas','Animais','Planetas','Comidas'], a: 0, explain: 'Algoritmos s√£o sequ√™ncias de instru√ß√µes que computadores seguem.'},
      {q: 'A IA pode dirigir carros?', opts: ['Sim, carros aut√¥nomos','N√£o, nunca','S√≥ caminh√µes','S√≥ avi√µes'], a: 0, explain: 'Carros aut√¥nomos usam IA para dirigir sem motorista humano.'},
      
      {q: 'O que √© Deep Learning?', opts: ['IA que aprende camadas profundas','Mergulho','Um jogo','Uma m√∫sica'], a: 0, explain: 'Deep Learning usa redes neurais com muitas camadas para aprender tarefas complexas.'},
      {q: 'A IA pode traduzir idiomas?', opts: ['Sim, traduz textos','N√£o, nunca','S√≥ ingl√™s','S√≥ espanhol'], a: 0, explain: 'Ferramentas como Google Tradutor usam IA para traduzir entre idiomas.'},
      {q: 'O que √© uma rede neural?', opts: ['Modelo inspirado no c√©rebro','Uma rede de pesca','Internet','Um jogo'], a: 0, explain: 'Redes neurais imitam como neur√¥nios no c√©rebro se conectam.'},
      {q: 'A IA pode ajudar o meio ambiente?', opts: ['Sim, monitorando polui√ß√£o','N√£o, nunca','S√≥ em filmes','S√≥ no espa√ßo'], a: 0, explain: 'IA pode analisar dados ambientais e ajudar a combater mudan√ßas clim√°ticas.'},
      {q: 'Por que devemos usar IA com responsabilidade?', opts: ['Para n√£o prejudicar pessoas','Porque √© dif√≠cil','Para ser r√°pido','Para ganhar dinheiro'], a: 0, explain: 'IA deve ser usada de forma √©tica para beneficiar a todos sem causar danos.'}
    ];

    let state = {
      index: 0,
      score: 0,
      hits: 0,
      lives: 3,
      phase: 1,
      total: QUESTIONS.length,
      answered: false,
      timerId: null
    };

    const els = {
      question: document.getElementById('question'),
      options: document.getElementById('options'),
      index: document.getElementById('index'),
      count: document.getElementById('count'),
      phase: document.getElementById('phase'),
      score: document.getElementById('score'),
      hits: document.getElementById('hits'),
      lives: document.getElementById('lives'),
      bar: document.getElementById('bar'),
      quizCard: document.getElementById('quizCard'),
      phaseScreen: document.getElementById('phaseScreen'),
      phaseTitle: document.getElementById('phaseTitle'),
      phaseMessage: document.getElementById('phaseMessage'),
      continuePhase: document.getElementById('continuePhase'),
      result: document.getElementById('result'),
      resultTitle: document.getElementById('resultTitle'),
      total: document.getElementById('total'),
      finalScore: document.getElementById('finalScore'),
      finalHits: document.getElementById('finalHits'),
      totalQuestions: document.getElementById('totalQuestions'),
      maxScore: document.getElementById('maxScore'),
      starRating: document.getElementById('starRating'),
      finalMessage: document.getElementById('finalMessage'),
      timer: document.getElementById('timer'),
      timeLeft: document.getElementById('timeLeft'),
      confetti: document.getElementById('confetti'),
      restart: document.getElementById('restart'),
      download: document.getElementById('download')
    };

    function shuffle(arr) {
      const array = [...arr];
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function triggerConfetti() {
      const canvas = els.confetti;
      if (!canvas) return;
      const ctx = canvas.getContext && canvas.getContext('2d');
      if (!ctx) return;
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      const particles = [];
      
      for (let i = 0; i < 80; i++) {
        particles.push({
          x: Math.random() * canvas.width,
          y: Math.random() * canvas.height - canvas.height,
          size: Math.random() * 8 + 4,
          speedX: Math.random() * 4 - 2,
          speedY: Math.random() * 3 + 2,
          color: `hsl(${Math.random() * 360}, 80%, 60%)`
        });
      }
      
      let frame = 0;
      function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        particles.forEach(p => {
          p.x += p.speedX;
          p.y += p.speedY;
          p.speedY += 0.1;
          ctx.fillStyle = p.color;
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
          ctx.fill();
        });
        frame++;
        if (frame < 120) {
          requestAnimationFrame(animate);
        } else {
          canvas.style.display = 'none';
        }
      }
      canvas.style.display = 'block';
      animate();
    }

    function updateProgress() {
      const pct = Math.round(((state.index + 1) / state.total) * 100);
      els.bar.style.width = pct + '%';
      els.score.textContent = state.score;
      els.hits.textContent = state.hits;
      els.lives.textContent = state.lives;
      els.index.textContent = state.index + 1;
      els.phase.textContent = state.phase;
      els.count.textContent = state.total;
      els.total.textContent = state.total;
    }

    function render() {
      // safety: if out of bounds, end quiz
      if (state.index < 0) state.index = 0;
      if (state.index >= state.total) {
        endQuiz('complete');
        return;
      }

      const item = QUESTIONS[state.index];
      state.answered = false;
      
      els.question.textContent = item.q;
      els.options.innerHTML = '';
      els.timer.style.display = 'none';
      
      const shuffled = shuffle(item.opts.map((opt, i) => ({ text: opt, index: i })));
      
      shuffled.forEach(opt => {
        const btn = document.createElement('button');
        btn.className = 'opt';
        btn.textContent = opt.text;
        btn.dataset.index = opt.index;
        btn.onclick = () => handleAnswer(opt.index);
        btn.onmouseenter = () => handleHover(btn, opt.index);
        els.options.appendChild(btn);
      });
      
      updateProgress();
      
      const bonusChance = Math.random() < 0.15 && state.index > 0;
      if (bonusChance) {
        startTimer();
      }
      
      enableTrickMode();
    }
    
    function handleHover(btn, optIndex) {
      const correct = QUESTIONS[state.index].a;
      
      if (optIndex !== correct && Math.random() < 0.25) {
        btn.style.transform = 'scale(1.15) rotate(5deg)';
        btn.style.borderColor = 'var(--success)';
        setTimeout(() => {
          btn.style.transform = '';
          btn.style.borderColor = '';
        }, 300);
      }
      
      if (optIndex === correct && Math.random() < 0.2) {
        btn.style.transform = 'scale(0.9)';
        btn.style.opacity = '0.5';
        setTimeout(() => {
          btn.style.transform = '';
          btn.style.opacity = '';
        }, 300);
      }
    }
    
    function enableTrickMode() {
      if (Math.random() < 0.3 && state.index > 2) {
        const correct = QUESTIONS[state.index].a;
        const buttons = Array.from(els.options.querySelectorAll('.opt'));
        const correctBtn = buttons.find(b => parseInt(b.dataset.index) === correct);
        
        if (correctBtn && Math.random() < 0.4) {
          correctBtn.dataset.dodgeCount = 0;
          // preserve previous behavior but be robust
          correctBtn.addEventListener('click', function dodgeHandler(e) {
            const dodges = parseInt(this.dataset.dodgeCount || 0);
            if (dodges < 2 && Math.random() < 0.6) {
              this.dataset.dodgeCount = dodges + 1;
              
              const container = els.options;
              const maxX = Math.max(0, container.offsetWidth - this.offsetWidth - 32);
              const maxY = Math.max(0, container.offsetHeight - this.offsetHeight - 32);
              
              this.style.position = 'absolute';
              this.style.left = Math.max(16, Math.random() * maxX) + 'px';
              this.style.top = Math.max(16, Math.random() * maxY) + 'px';
              this.style.transition = 'all 0.3s ease';
              
              const taunt = ['üòú Opa!', 'ü§™ Quase!', 'üòÜ Tente de novo!', 'üéØ Me pegue!'];
              const oldText = this.textContent;
              this.textContent = taunt[Math.floor(Math.random() * taunt.length)];
              
              setTimeout(() => {
                this.textContent = oldText;
              }, 800);
              
              e.stopPropagation();
              return;
            }
            
            // restore position and proceed
            this.style.position = 'relative';
            this.style.left = '0';
            this.style.top = '0';
            handleAnswer(correct);
          }, { once: true });
        }
        
        if (Math.random() < 0.3) {
          setTimeout(() => {
            buttons.forEach((btn, i) => {
              setTimeout(() => {
                btn.style.transition = 'transform 0.3s ease';
                btn.style.transform = 'translateX(' + (Math.random() * 20 - 10) + 'px)';
                setTimeout(() => {
                  btn.style.transform = '';
                }, 400);
              }, i * 100);
            });
          }, 1000);
        }
      }
      
      if (Math.random() < 0.2) {
        setTimeout(() => {
          const wrongButtons = Array.from(els.options.querySelectorAll('.opt'))
            .filter(b => parseInt(b.dataset.index) !== QUESTIONS[state.index].a);
          
          wrongButtons.forEach(btn => {
            if (Math.random() < 0.3) {
              btn.style.boxShadow = '0 0 20px rgba(40, 167, 69, 0.6)';
              setTimeout(() => {
                btn.style.boxShadow = '';
              }, 1500);
            }
          });
        }, 500);
      }
    }

    function startTimer() {
      els.timer.style.display = 'block';
      let timeLeft = 10;
      els.timeLeft.textContent = timeLeft;
      
      if (state.timerId) {
        clearInterval(state.timerId);
        state.timerId = null;
      }
      
      state.timerId = setInterval(() => {
        timeLeft--;
        els.timeLeft.textContent = timeLeft;
        
        if (timeLeft <= 0) {
          clearInterval(state.timerId);
          state.timerId = null;
          if (!state.answered) {
            handleAnswer(-1);
          }
        }
      }, 1000);
    }

    function handleAnswer(chosen) {
      if (state.answered) return;
      
      state.answered = true;
      
      if (state.timerId) {
        clearInterval(state.timerId);
        state.timerId = null;
        els.timer.style.display = 'none';
      }
      
      const correct = QUESTIONS[state.index].a;
      const buttons = els.options.querySelectorAll('.opt');
      
      buttons.forEach(btn => {
        btn.classList.add('disabled');
        const btnIndex = parseInt(btn.dataset.index);
        
        if (btnIndex === correct) {
          btn.classList.add('correct');
        } else if (btnIndex === chosen) {
          btn.classList.add('wrong');
        }
      });
      
      if (chosen === correct) {
        state.score += 10;
        state.hits++;
      } else {
        state.lives--;
      }
      
      const expl = document.createElement('div');
      expl.className = 'explain';
      expl.textContent = QUESTIONS[state.index].explain;
      els.quizCard.appendChild(expl);
      
      updateProgress();
      
      setTimeout(() => {
        expl.remove();
        
        if (state.lives <= 0) {
          endQuiz('gameover');
        } else if (state.index >= state.total - 1) {
          endQuiz('complete');
        } else if ((state.index + 1) % 5 === 0) {
          showPhaseScreen();
        } else {
          state.index++;
          state.phase = Math.floor(state.index / 5) + 1;
          render();
        }
      }, 2500);
    }

    function showPhaseScreen() {
      els.quizCard.style.display = 'none';
      els.phaseScreen.style.display = 'block';
      
      const phaseNames = ['Explorador de IA', 'Mestre dos Rob√¥s', 'Cientista de Dados', 'G√™nio da IA'];
      const currentPhase = Math.floor(state.index / 5);
      
      els.phaseTitle.textContent = `Fase ${currentPhase + 1} Conclu√≠da! üéâ`;
      els.phaseMessage.textContent = `Parab√©ns! Voc√™ √© agora um "${phaseNames[currentPhase] || 'Aventureiro da IA'}"! Continue sua jornada pelo mundo da IA!`;
      
      triggerConfetti();
    }

    // Use addEventListener (mais resiliente) e preven√ß√£o de overflow de √≠ndice
    if (els.continuePhase) {
      els.continuePhase.addEventListener('click', () => {
        // se j√° estivermos no final, encerra
        if (state.index >= state.total - 1) {
          endQuiz('complete');
          return;
        }
        els.phaseScreen.style.display = 'none';
        els.quizCard.style.display = 'block';
        state.index++;
        state.phase = Math.floor(state.index / 5) + 1;
        render();
      });
    }

    function endQuiz(status) {
      els.quizCard.style.display = 'none';
      els.phaseScreen.style.display = 'none';
      els.result.style.display = 'block';
      
      els.finalScore.textContent = state.score;
      els.finalHits.textContent = state.hits;
      els.totalQuestions.textContent = state.total;
      els.maxScore.textContent = state.total * 10;
      
      const pct = Math.round((state.hits / state.total) * 100);
      let msg = '';
      let stars = '‚òÖ‚òÜ‚òÜ';
      let title = 'Fim da Aventura! üéâ';
      
      if (status === 'gameover') {
        title = 'Game Over! üò¢';
        msg = 'Voc√™ ficou sem vidas, mas foi uma grande aventura! A pr√°tica leva √† perfei√ß√£o. Tente novamente e mostre do que voc√™ √© capaz!';
        stars = '‚òÜ‚òÜ‚òÜ';
      } else {
        if (pct >= 80) {
          msg = 'Incr√≠vel! Voc√™ √© um verdadeiro G√™nio da IA! üöÄ Seu conhecimento sobre intelig√™ncia artificial √© excepcional!';
          stars = '‚òÖ‚òÖ‚òÖ';
          triggerConfetti();
        } else if (pct >= 60) {
          msg = 'Muito bem! Voc√™ tem um √≥timo entendimento sobre IA! ‚ú® Continue explorando este fascinante mundo da tecnologia!';
          stars = '‚òÖ‚òÖ‚òÜ';
        } else {
          msg = 'Bom come√ßo! Continue curioso e explorando! üôÇ Cada pergunta √© uma oportunidade de aprender algo novo sobre IA!';
          stars = '‚òÖ‚òÜ‚òÜ';
        }
      }
      
      els.resultTitle.textContent = title;
      els.finalMessage.textContent = msg + '\n\nü§ñ Lembre-se: A Intelig√™ncia Artificial √© uma ferramenta poderosa que deve ser usada com responsabilidade para ajudar as pessoas e tornar o mundo melhor!';
      els.starRating.textContent = stars;
    }

    els.restart.addEventListener('click', () => {
      // reset state
      state = {
        index: 0,
        score: 0,
        hits: 0,
        lives: 3,
        phase: 1,
        total: QUESTIONS.length,
        answered: false,
        timerId: null
      };
      
      els.result.style.display = 'none';
      els.quizCard.style.display = 'block';
      render();
    });

    els.download.addEventListener('click', () => {
      const results = {
        totalPerguntas: state.total,
        pontuacao: state.score,
        acertos: state.hits,
        vidasRestantes: state.lives,
        faseAlcancada: state.phase,
        data: new Date().toLocaleString('pt-BR')
      };
      
      const blob = new Blob([JSON.stringify(results, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'resultado_quiz_ia.json';
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    });

    // inicializa contadores e render
    updateProgress();
    render();
  </script>
</body>
</html>
